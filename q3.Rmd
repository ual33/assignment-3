---
title: "Question 3"
---

```{r}
library(tidyverse)
```

Consider the function `slr` which returns the intercept and slope of a simple linear regression model.

```{r}
# get a column of data
get_column <- function(data, x) {
    pull(select(data, x))
}
```

```{r}
get_mean <- function(data, y) {
  mean(get_column(data, y), na.rm = TRUE)
}
```

```{r}
dot <- function(y, x) {
  sum(x * y)
}
```


```{r}
slr <- function(data) {
  x <- data$x
  y <- data$y
  mux <- get_mean(data, "x")
  muy <- get_mean(data, "y")
  sxy <- dot(x - mux, y - muy)
  sxx <- dot(x - mux, x - mux)
  slope <- sxy / sxx
  intercept <- muy - slope * mux
  c(intercept, slope)
}
```

Despite of the inefficiency of some part of the code, this code is erroneous and doesn't return the correct result.

```{r}
df <- tibble(x = rnorm(10), y = rnorm(10))
all.equal(
  slr(df),
  coef(lm(y ~ x, data = df)),
  check.attributes = FALSE)
```


##### Could you find the culprit and provide a targeted fix (minimal changes to the code)?

Hint: you could use `browser()`, `debug`/`undebug` or `debugonce` to debug the functions.





```{r}
stopifnot(
  all.equal(
    slr(df),
    coef(lm(y ~ x, data = df)),
    check.attributes = FALSE)
)
```

